<div class="p-4">
  <div class="text-center mb-6">
    <h2 class="text-2xl font-bold text-gray-800">Resumen de Solicitud</h2>
    <p class="text-gray-600">Revise la información antes de guardar la solicitud</p>
  </div>

  <!-- Mensaje cuando no hay datos -->
  <div *ngIf="!fichaTrabajo?.cliente && !solicitud?.monto" class="p-4 bg-yellow-50 border-round text-center">
    <i class="pi pi-info-circle text-yellow-500 text-2xl mb-3 block"></i>
    <h3 class="text-xl font-medium text-yellow-700 mb-2">No hay datos disponibles</h3>
    <p class="text-yellow-600">
      No se encontraron datos para mostrar en el resumen. Por favor, complete los formularios en las pestañas anteriores.
    </p>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="solicitud">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Información General</h3>

    <div class="grid">
      <div class="col-12 md:col-6">
        <div class="mb-3" *ngIf="solicitud?.n_credito">
          <span class="font-bold text-gray-700">Número de Crédito:</span>
          <span class="ml-2">{{ solicitud.n_credito }}</span>
        </div>
        <div class="mb-3" *ngIf="solicitud?.fecha">
          <span class="font-bold text-gray-700">Fecha:</span>
          <span class="ml-2">{{ formatoFecha(solicitud.fecha) }}</span>
        </div>
        <div class="mb-3" *ngIf="solicitud?.periodo">
          <span class="font-bold text-gray-700">Periodo:</span>
          <span class="ml-2">{{ solicitud.periodo?.descripcion || solicitud.periodo }}</span>
        </div>
      </div>
      <div class="col-12 md:col-6">
        <div class="mb-3" *ngIf="solicitud?.monto">
          <span class="font-bold text-gray-700">Monto:</span>
          <span class="ml-2">{{ formatoMoneda(solicitud.monto) }}</span>
        </div>
        <div class="mb-3" *ngIf="solicitud?.plazo">
          <span class="font-bold text-gray-700">Plazo:</span>
          <span class="ml-2">{{ solicitud.plazo }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="fichaTrabajo?.cliente">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Datos del Cliente</h3>

    <div class="grid">
      <div class="col-12">
        <div class="mb-3" *ngIf="fichaTrabajo.cliente.nombres || fichaTrabajo.cliente.apellidos">
          <span class="font-bold text-gray-700">Nombre Completo:</span>
          <span class="ml-2">{{ fichaTrabajo.cliente.nombres }} {{ fichaTrabajo.cliente.apellidos }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="fichaTrabajo?.aval">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Datos del Aval</h3>

    <div *ngIf="fichaTrabajo.aval.omitido" class="p-3 bg-blue-50 border-left-3 border-blue-500 mb-3">
      <span class="text-blue-700">Aval omitido: {{ fichaTrabajo.aval.motivo }}</span>
    </div>

    <div *ngIf="!fichaTrabajo.aval.omitido" class="grid">
      <div class="col-12">
        <div class="mb-3" *ngIf="fichaTrabajo.aval.nombres || fichaTrabajo.aval.apellidos">
          <span class="font-bold text-gray-700">Nombre Completo:</span>
          <span class="ml-2">{{ fichaTrabajo.aval.nombres }} {{ fichaTrabajo.aval.apellidos }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="fichaTrabajo?.conyuge">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Datos del Cónyuge</h3>

    <div *ngIf="fichaTrabajo.conyuge.omitido" class="p-3 bg-blue-50 border-left-3 border-blue-500 mb-3">
      <span class="text-blue-700">Cónyuge omitido: {{ fichaTrabajo.conyuge.motivo }}</span>
    </div>

    <div *ngIf="!fichaTrabajo.conyuge.omitido" class="grid">
      <div class="col-12">
        <div class="mb-3" *ngIf="fichaTrabajo.conyuge.nombres || fichaTrabajo.conyuge.apellidos">
          <span class="font-bold text-gray-700">Nombre Completo:</span>
          <span class="ml-2">{{ fichaTrabajo.conyuge.nombres }} {{ fichaTrabajo.conyuge.apellidos }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="fichaTrabajo?.detalleEconomico">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Actividad Económica</h3>

    <!-- Sección de Negocio -->
    <div *ngIf="fichaTrabajo.detalleEconomico.negocio">
      <div class="p-3 bg-blue-50 border-round mb-3">
        <span class="font-bold text-blue-800">Tipo de Actividad: Negocio</span>
      </div>

      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="mb-3" *ngIf="fichaTrabajo.detalleEconomico.negocio.actividad_economica?.descripcion">
            <span class="font-bold text-gray-700">Actividad:</span>
            <span class="ml-2">{{ fichaTrabajo.detalleEconomico.negocio.actividad_economica.descripcion }}</span>
          </div>
        </div>
        <div class="col-12 md:col-6">
          <div class="mb-3" *ngIf="fichaTrabajo.detalleEconomico.negocio.registro_ventas?.ventas_normales">
            <span class="font-bold text-gray-700">Ventas Normales:</span>
            <span class="ml-2">{{ formatoMoneda(fichaTrabajo.detalleEconomico.negocio.registro_ventas.ventas_normales) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Sección de Ingreso Dependiente -->
    <div *ngIf="fichaTrabajo.detalleEconomico.ingreso_dependiente">
      <div class="p-3 bg-blue-50 border-round mb-3">
        <span class="font-bold text-blue-800">Tipo de Actividad: Ingreso Dependiente</span>
      </div>

      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="mb-3" *ngIf="fichaTrabajo.detalleEconomico.ingreso_dependiente.actividad">
            <span class="font-bold text-gray-700">Actividad:</span>
            <span class="ml-2">{{ fichaTrabajo.detalleEconomico.ingreso_dependiente.actividad }}</span>
          </div>
        </div>
        <div class="col-12 md:col-6">
          <div class="mb-3" *ngIf="fichaTrabajo.detalleEconomico.ingreso_dependiente.importe">
            <span class="font-bold text-gray-700">Importe:</span>
            <span class="ml-2">{{ formatoMoneda(fichaTrabajo.detalleEconomico.ingreso_dependiente.importe) }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="fichaTrabajo?.ingreso_adicional">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Ingreso Adicional</h3>

    <div *ngIf="fichaTrabajo.ingreso_adicional.omitido" class="p-3 bg-blue-50 border-left-3 border-blue-500 mb-3">
      <span class="text-blue-700">Ingreso adicional omitido</span>
    </div>

    <div *ngIf="!fichaTrabajo.ingreso_adicional.omitido">
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="mb-3" *ngIf="fichaTrabajo.ingreso_adicional.actividad">
            <span class="font-bold text-gray-700">Actividad:</span>
            <span class="ml-2">{{ fichaTrabajo.ingreso_adicional.actividad }}</span>
          </div>
        </div>
        <div class="col-12 md:col-6">
          <div class="mb-3" *ngIf="fichaTrabajo.ingreso_adicional.importe_act !== undefined">
            <span class="font-bold text-gray-700">Importe:</span>
            <span class="ml-2">{{ formatoMoneda(fichaTrabajo.ingreso_adicional.importe_act) }}</span>
          </div>
        </div>
      </div>

      <!-- Información de Aporte de Terceros -->
      <div *ngIf="fichaTrabajo.ingreso_adicional.aportante?.descripcion || fichaTrabajo.ingreso_adicional.importe_tercero" class="mt-4">
        <div class="p-3 bg-blue-50 border-round mb-3">
          <span class="font-bold text-blue-800">Aporte de Terceros</span>
        </div>

        <div class="grid">
          <div class="col-12 md:col-6">
            <div class="mb-3" *ngIf="fichaTrabajo.ingreso_adicional.aportante?.descripcion">
              <span class="font-bold text-gray-700">Aportante:</span>
              <span class="ml-2">{{ fichaTrabajo.ingreso_adicional.aportante.descripcion }}</span>
            </div>
          </div>
          <div class="col-12 md:col-6">
            <div class="mb-3" *ngIf="fichaTrabajo.ingreso_adicional.importe_tercero !== undefined">
              <span class="font-bold text-gray-700">Importe:</span>
              <span class="ml-2">{{ formatoMoneda(fichaTrabajo.ingreso_adicional.importe_tercero) }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="fichaTrabajo?.gasto_financieros">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Gastos Financieros</h3>

    <div *ngIf="fichaTrabajo.gasto_financieros.length === 0" class="p-3 bg-blue-50 border-left-3 border-blue-500 mb-3">
      <span class="text-blue-700">No se registraron gastos financieros</span>
    </div>

    <div *ngIf="fichaTrabajo.gasto_financieros.length > 0">
      <div *ngFor="let gasto of fichaTrabajo.gasto_financieros; let i = index" class="p-3 mb-2" [ngClass]="{'bg-gray-50': i % 2 === 0}">
        <div class="grid">
          <div class="col-12 md:col-6" *ngIf="gasto.entidad?.descripcion">
            <span class="font-bold text-gray-700">Entidad:</span>
            <span class="ml-2">{{ gasto.entidad.descripcion }}</span>
          </div>
          <div class="col-12 md:col-6" *ngIf="gasto.monto_credito !== undefined">
            <span class="font-bold text-gray-700">Monto:</span>
            <span class="ml-2">{{ formatoMoneda(gasto.monto_credito) }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="fichaTrabajo?.referencia_familiar">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Referencia Familiar</h3>

    <div *ngIf="fichaTrabajo.referencia_familiar.omitido" class="p-3 bg-blue-50 border-left-3 border-blue-500 mb-3">
      <span class="text-blue-700">Referencia familiar omitida</span>
    </div>

    <div *ngIf="!fichaTrabajo.referencia_familiar.omitido">
      <div class="mb-3" *ngIf="fichaTrabajo.referencia_familiar.referencia_domicilio">
        <span class="font-bold text-gray-700">Referencia de Domicilio:</span>
        <span class="ml-2">{{ fichaTrabajo.referencia_familiar.referencia_domicilio }}</span>
      </div>
    </div>
  </div>

  <div class="card p-4 border-1 border-gray-200 mb-4" *ngIf="solicitud?.puntaje_sentinel">
    <h3 class="text-xl font-bold text-gray-700 mb-3 border-bottom-1 border-gray-300 pb-2">Puntaje Sentinel</h3>

    <div class="grid">
      <div class="col-12">
        <div class="mb-3">
          <span class="font-bold text-gray-700">Puntaje:</span>
          <span class="ml-2">{{ solicitud.puntaje_sentinel }}</span>
          <span class="ml-2" [ngClass]="{
            'text-green-600': solicitud.puntaje_sentinel >= 598,
            'text-yellow-600': solicitud.puntaje_sentinel >= 147 && solicitud.puntaje_sentinel < 598,
            'text-red-600': solicitud.puntaje_sentinel < 147
          }">{{ getNombreRangoPuntaje(solicitud.puntaje_sentinel) }}</span>
        </div>
      </div>
    </div>
  </div>


</div>
